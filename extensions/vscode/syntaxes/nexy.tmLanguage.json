{
  "$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
  "name": "Nexy",
  "scopeName": "source.nexy",
  "fileTypes": [
    "nexy"
  ],
  "patterns": [
    {
      "include": "#header"
    },
    {
      "include": "#template"
    }
  ],
  "repository": {
    
    "header": {
      "name": "meta.header.nexy",
      "begin": "^(---)\\s*$",
      "beginCaptures": {
        "1": {
          "name": "punctuation.definition.header.begin.nexy"
        }
      },
      "end": "^(---)\\s*$",
      "endCaptures": {
        "1": {
          "name": "punctuation.definition.header.end.nexy"
        }
      },
      "patterns": [
        {
          "include": "source.python"
        },
        {
          "name": "keyword.control.import.python.fallback.nexy",
          "match": "\\b(import|from|as|with|def|class|return|True|False|None)\\b"
        },
        { "include": "#python-import-from" },
        { "include": "#python-import-list" },
        { "include": "#python-assignment" },
        {
          "include": "#nexy-prop"
        }
      ]
    },
    "nexy-prop": {
      "name": "storage.type.nexy",
      "match": "\\bprop\\b"
    },
    "python-import-list": {
      "name": "meta.import.python.fallback.nexy",
      "begin": "^\\s*(import)\\s+",
      "beginCaptures": {
        "1": { "name": "keyword.control.import.python.fallback.nexy" }
      },
      "end": "$",
      "patterns": [
        {
          "match": "(?:\"[^\"]+\"|'[^']+'|[A-Za-z_][\\w.]*)",
          "name": "entity.name.namespace.python.nexy"
        },
        { "match": ",", "name": "punctuation.separator.comma.python.nexy" },
        {
          "match": "\\s+as\\s+",
          "name": "keyword.other.as.python.fallback.nexy"
        },
        { "match": "[A-Za-z_][\\w]*", "name": "variable.other.alias.python.nexy" }
      ]
    },
    "python-import-from": {
      "name": "meta.from-import.python.fallback.nexy",
      "begin": "^\\s*(from)\\s+",
      "beginCaptures": {
        "1": { "name": "keyword.control.import.python.fallback.nexy" }
      },
      "end": "$",
      "patterns": [
        {
          "match": "(?:[A-Za-z_][\\w.]*|\"[^\"]+\"|'[^']+')",
          "name": "entity.name.namespace.python.nexy"
        },
        {
          "match": "\\s+(import)\\s+",
          "captures": { "1": { "name": "keyword.control.import.python.fallback.nexy" } }
        },
        { "match": "[A-Za-z_][\\w]*", "name": "entity.name.imported.python.nexy" },
        { "match": ",", "name": "punctuation.separator.comma.python.nexy" },
        {
          "match": "\\s+as\\s+",
          "name": "keyword.other.as.python.fallback.nexy"
        },
        { "match": "[A-Za-z_][\\w]*", "name": "variable.other.alias.python.nexy" }
      ]
    },
    "python-assignment": {
      "name": "meta.assignment.python.fallback.nexy",
      "match": "^\\s*([A-Za-z_][\\w]*)\\s*(?::[^=]+)?\\s*(=)",
      "captures": {
        "1": { "name": "variable.other.readwrite.python.nexy" },
        "2": { "name": "keyword.operator.assignment.python.nexy" }
      }
    },
    "nexy-prop-decl": {
      "name": "meta.declaration.prop.nexy",
      "begin": "^\\s*([A-Za-z_][\\w]*)\\s*:\\s*(prop)(\\[)",
      "beginCaptures": {
        "1": { "name": "variable.other.readwrite.nexy" },
        "2": { "name": "storage.type.nexy" },
        "3": { "name": "punctuation.section.brackets.begin.nexy" }
      },
      "end": "\\]",
      "endCaptures": {
        "0": { "name": "punctuation.section.brackets.end.nexy" }
      },
      "patterns": [
        { "match": "[^\\]]+", "name": "support.type.nexy" }
      ]
    },
    "template": {
      "name": "meta.template.nexy",
      "begin": "(?<=^---)\\s*$|(?:^(?!---))",
      "end": "(?=^---\\s*$)",
      "patterns": [
        {
          "include": "#jinja-comment"
        },
        {
          "include": "#jinja-block"
        },
        {
          "include": "#jinja-expression"
        },
        {
          "include": "#style-tag"
        },
        {
          "include": "#script-tag"
        },
        {
          "include": "#component-tag-open"
        },
        {
          "include": "#custom-component"
        },
        {
          "include": "text.html.basic"
        }
      ]
    },
    "style-tag": {
      "begin": "(<)(style)(?:\\s+lang\\s*=\\s*[\"'](scss|sass|less|postcss)[\"'])?\\s*(>)",
      "beginCaptures": {
        "1": { "name": "punctuation.definition.tag.begin.html" },
        "2": { "name": "entity.name.tag.style.html" },
        "3": { "name": "entity.other.attribute-name.html" },
        "4": { "name": "punctuation.definition.tag.end.html" }
      },
      "end": "(</)(style)(>)",
      "endCaptures": {
        "1": { "name": "punctuation.definition.tag.begin.html" },
        "2": { "name": "entity.name.tag.style.html" },
        "3": { "name": "punctuation.definition.tag.end.html" }
      },
      "patterns": [
        {
          "begin": "(?<=<style\\s+lang=[\"']scss[\"']>)",
          "end": "(?=</style>)",
          "contentName": "source.css.scss",
          "include": "source.css.scss"
        },
        {
          "begin": "(?<=<style\\s+lang=[\"']sass[\"']>)",
          "end": "(?=</style>)",
          "contentName": "source.sass",
          "include": "source.sass"
        },
        {
          "begin": "(?<=<style\\s+lang=[\"']less[\"']>)",
          "end": "(?=</style>)",
          "contentName": "source.css.less",
          "include": "source.css.less"
        },
        {
          "begin": "(?<=<style>)",
          "end": "(?=</style>)",
          "contentName": "source.css",
          "include": "source.css"
        },
        { "include": "source.css" }
      ]
    },
    "script-tag": {
      "begin": "(<)(script)(?:\\s+lang\\s*=\\s*[\"'](ts|tsx|jsx|rust)[\"'])?\\s*(>)",
      "beginCaptures": {
        "1": { "name": "punctuation.definition.tag.begin.html" },
        "2": { "name": "entity.name.tag.script.html" },
        "3": { "name": "entity.other.attribute-name.html" },
        "4": { "name": "punctuation.definition.tag.end.html" }
      },
      "end": "(</)(script)(>)",
      "endCaptures": {
        "1": { "name": "punctuation.definition.tag.begin.html" },
        "2": { "name": "entity.name.tag.script.html" },
        "3": { "name": "punctuation.definition.tag.end.html" }
      },
      "patterns": [
        {
          "begin": "(?<=<script\\s+lang=[\"']ts[\"']>)",
          "end": "(?=</script>)",
          "contentName": "source.ts",
          "include": "source.ts"
        },
        {
          "begin": "(?<=<script\\s+lang=[\"']tsx[\"']>)",
          "end": "(?=</script>)",
          "contentName": "source.tsx",
          "include": "source.tsx"
        },
        {
          "begin": "(?<=<script\\s+lang=[\"']rust[\"']>)",
          "end": "(?=</script>)",
          "contentName": "source.rust",
          "include": "source.rust"
        },
        {
          "begin": "(?<=<script>)",
          "end": "(?=</script>)",
          "contentName": "source.js",
          "include": "source.js"
        },
        { "include": "source.js" }
      ]
    },
    "jinja-expression": {
      "name": "meta.embedded.jinja.expression.nexy",
      "begin": "\\{\\{",
      "beginCaptures": {
        "0": {
          "name": "punctuation.definition.template-expression.begin.jinja2"
        }
      },
      "end": "\\}\\}",
      "endCaptures": {
        "0": {
          "name": "punctuation.definition.template-expression.end.jinja2"
        }
      },
      "patterns": [
        {
          "include": "source.python"
        },
        {
          "name": "variable.other.readwrite.fallback.nexy",
          "match": "\\b[_A-Za-z][_A-Za-z0-9]*\\b"
        }
      ]
    },
    "jinja-block": {
      "name": "meta.embedded.jinja.block.nexy",
      "begin": "\\{%[-]?",
      "beginCaptures": {
        "0": {
          "name": "punctuation.definition.template-block.begin.jinja2"
        }
      },
      "end": "[-]?%\\}",
      "endCaptures": {
        "0": {
          "name": "punctuation.definition.template-block.end.jinja2"
        }
      },
      "patterns": [
        {
          "match": "\\b(if|elif|else|endif|for|endfor|block|endblock|extends|include|macro|endmacro|call|endcall|filter|endfilter|set|del|raw|endraw|with|endwith|without|context|import|from|as|not|and|or|in|is)\\b",
          "name": "keyword.control.jinja2"
        },
        {
          "include": "source.python"
        }
      ]
    },
    "jinja-comment": {
      "name": "comment.block.jinja2.nexy",
      "begin": "\\{#",
      "beginCaptures": {
        "0": {
          "name": "punctuation.definition.comment.begin.jinja2"
        }
      },
      "end": "#\\}",
      "endCaptures": {
        "0": {
          "name": "punctuation.definition.comment.end.jinja2"
        }
      }
    },
    "component-tag-open": {
      "name": "meta.tag.component.start.nexy",
      "begin": "(<)([A-Z][A-Za-z0-9]*)",
      "beginCaptures": {
        "1": { "name": "punctuation.definition.tag.begin.nexy" },
        "2": { "name": "entity.name.tag.component.nexy support.class.component.nexy" }
      },
      "end": "(\\/?>)",
      "endCaptures": {
        "1": { "name": "punctuation.definition.tag.end.nexy" }
      },
      "patterns": [
        { "include": "#component-attributes" },
        { "include": "#jinja-expression" }
      ]
    },
    "component-attributes": {
      "name": "meta.tag.attributes.nexy",
      "patterns": [
        {
          "name": "entity.other.attribute-name.nexy",
          "match": "(?<=\\s)([@:\\w][\\w:.-]*)(?=\\s*=|\\s|\\/?>)"
        },
        {
          "name": "keyword.operator.assignment.nexy",
          "match": "="
        },
        {
          "name": "string.quoted.double.nexy",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            { "include": "#jinja-expression" }
          ]
        },
        {
          "name": "string.quoted.single.nexy",
          "begin": "'",
          "end": "'",
          "patterns": [
            { "include": "#jinja-expression" }
          ]
        },
        {
          "name": "constant.language.boolean.nexy",
          "match": "\\b(true|false)\\b"
        },
        {
          "name": "constant.numeric.nexy",
          "match": "\\b\\d+(?:\\.\\d+)?\\b"
        },
        {
          "name": "variable.other.attribute.unquoted.nexy",
          "match": "(?<=\\=)(?![\"'])([^\\s>]+)"
        }
      ]
    },
    "custom-component": {
      "name": "meta.tag.component.end.nexy",
      "match": "(</)([A-Z][A-Za-z0-9]*)(>)",
      "captures": {
        "1": { "name": "punctuation.definition.tag.begin.nexy" },
        "2": { "name": "entity.name.tag.component.nexy support.class.component.nexy" },
        "3": { "name": "punctuation.definition.tag.end.nexy" }
      }
    }
  }
}
